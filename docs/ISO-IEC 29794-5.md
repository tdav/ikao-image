# ISO/IEC 29794-5: полное руководство по стандарту качества изображений лица

**ISO/IEC 29794-5:2025 определяет 34 компонента качества лицевого изображения**, каждый из которых оценивается по единой шкале 0–100 и охватывает всё — от резкости и позы головы до окклюзии и компрессионных артефактов. Стандарт впервые опубликован как полноценный International Standard в апреле 2025 года (заменив технический отчёт TR 2010 года) и уже имеет эталонную open-source реализацию OFIQ, занявшую 1-е место из 52 алгоритмов в тестировании NIST FATE Quality. Для интеграции с .NET/WebAssembly наиболее практичный путь — REST API обёртка BQAT-API поверх OFIQ или коммерческие SDK (Regula, Innovatrics) с готовыми HTTP-интерфейсами.

---

## Архитектура стандарта и система оценки

ISO/IEC 29794-5:2025 разработан подкомитетом JTC 1/SC 37/WG 3 при ключевом участии Christoph Busch (Hochschule Darmstadt), Patrick Grother (NIST) и команды secunet. Стандарт входит в серию ISO/IEC 29794, где часть 1 задаёт фреймворк, а часть 5 — конкретизацию для лицевых изображений.

Система оценки строится на двух уровнях. **Unified Quality Score (UQS)** — холистическая оценка, предсказывающая вероятность успешного распознавания, целое число **0–100** (чем выше, тем лучше). **Quality Component Values (QCV)** — оценки отдельных аспектов качества, также **0–100**. Каждый алгоритм оценки (Quality Assessment Algorithm, QAA) генерирует «native quality measure» — сырое значение в собственной шкале, которое затем отображается в стандартизованный диапазон 0–100 через заданную функцию маппинга. Значение **-1** зарезервировано для ситуации «failure to assess» — невозможности вычислить компонент.

Стандарт определяет три сценария использования с различными требованиями к обязательности компонентов:

- **UC1** — сбор эталонных изображений для документов, удостоверяющих личность (паспорта, MRTD) — максимальные требования, **20 обязательных компонентов**
- **UC2** — живая регистрация в системе (например, киоски EU EES) — **14 обязательных компонентов**
- **UC3** — сбор зондовых изображений для мгновенного распознавания (например, ABC-гейты) — **6 обязательных компонентов**

---

## Полный перечень 34 компонентов качества

Стандарт определяет **28 компонентов в основном тексте** (Clause 7) и **6 дополнительных в информативном Annex D**. Ниже приведена полная таблица с указанием обязательности по сценариям.

| № | Компонент качества | Раздел | UC1 | UC2 | UC3 |
|---|---|---|---|---|---|
| 1 | Unified Quality Score | 7.2 | **M** | **M** | **M** |
| 2 | Background Uniformity | 7.3.2 | **M** | O | O |
| 3 | Illumination Uniformity | 7.3.3 | **M** | O | O |
| 4 | Luminance Mean | 7.3.4.2 | O | O | O |
| 5 | Luminance Variance | 7.3.4.3 | **M** | O | O |
| 6 | Under-Exposure Prevention | 7.3.5 | O | O | O |
| 7 | Over-Exposure Prevention | 7.3.6 | O | O | O |
| 8 | Dynamic Range | 7.3.7 | **M** | O | O |
| 9 | Sharpness | 7.3.8 | **M** | O | O |
| 10 | No Compression Artefacts | 7.3.9 | O | O | O |
| 11 | Natural Colour | 7.3.10 | O | O | O |
| 12 | Single Face Present | 7.4.2 | **M** | **M** | O |
| 13 | Eyes Open | 7.4.3 | **M** | O | O |
| 14 | Mouth Closed | 7.4.4 | **M** | **M** | O |
| 15 | Eyes Visible | 7.4.5 | **M** | **M** | O |
| 16 | Mouth Occlusion Prevention | 7.4.6 | **M** | **M** | O |
| 17 | Face Occlusion Prevention | 7.4.7 | **M** | **M** | O |
| 18 | Inter-Eye Distance | 7.4.8 | **M** | **M** | **M** |
| 19 | Head Size | 7.4.9 | **M** | **M** | **M** |
| 20 | Leftward Crop of Face | 7.4.10.1 | **M** | **M** | **M** |
| 21 | Rightward Crop of Face | 7.4.10.2 | **M** | **M** | **M** |
| 22 | Margin Above Face | 7.4.10.3 | **M** | **M** | **M** |
| 23 | Margin Below Face | 7.4.10.4 | **M** | **M** | **M** |
| 24 | Pose Angle Yaw | 7.4.11.2 | **M** | **M** | O |
| 25 | Pose Angle Pitch | 7.4.11.3 | **M** | **M** | O |
| 26 | Pose Angle Roll | 7.4.11.4 | **M** | **M** | O |
| 27 | Expression Neutrality | 7.4.12 | **M** | O | O |
| 28 | No Head Covering | 7.4.13 | **M** | O | O |
| 29 | Radial Distortion | D.2.1 | O | O | O |
| 30 | Pixel Aspect Ratio | D.2.2 | O | O | O |
| 31 | Gaze | D.3.1 | O | O | O |
| 32 | Shoulder Presentation | D.3.2 | O | O | O |
| 33 | Camera Subject Distance | D.3.3 | O | O | O |
| 34 | Motion Blur Prevention | D.3.4 | O | O | O |

**M** = Mandatory (обязательный); **O** = Optional (необязательный)

---

## Технические характеристики изображения

### Разрешение и размеры

Стандарт ISO/IEC 29794-5 не задаёт фиксированные размеры изображения в пикселях — вместо этого критерием служит **Inter-Eye Distance (IED)**, измеренный как расстояние в пикселях между центрами глаз. По ссылочным стандартам ISO/IEC 19794-5 и ISO/IEC 39794-5, а также ICAO Doc 9303:

- **Минимальный IED**: ≥ **90 пикселей** (обязательное требование для хранения на чипе MRTD)
- **Рекомендуемый IED**: ≥ **120 пикселей** (best practice для чипа)
- **Оптимальный IED**: ≥ **240 пикселей** (best practice для живого захвата и подачи документов)
- **Минимум захвата**: рекомендуемый размер захваченного изображения **1200 × 1600 пикселей** (ICAO TR Portrait Quality)

Компонент **Inter-Eye Distance** (7.4.8) в 29794-5 измеряет IED на основе ландмарков глаз и маппит значение в шкалу 0–100. Этот компонент обязателен для **всех трёх сценариев**.

### Head Size (7.4.9) — размер головы в кадре

Оценивает, занимает ли голова корректную пропорцию кадра. По ICAO Doc 9303 и ISO 19794-5:

- **Цифровое изображение (для чипа)**: высота лица (подбородок–макушка) = **50–69%** от высоты изображения
- **Физическая фотография 35 × 45 мм**: высота лица = **32–36 мм** (70–80% от 45 мм)
- Линия глаз должна находиться в определённой вертикальной зоне кадра

### Crop of Face Image (7.4.10) — кадрирование

Четыре подкомпонента проверяют достаточность полей вокруг лица:

- **Leftward Crop** (7.4.10.1) — поле слева от лица
- **Rightward Crop** (7.4.10.2) — поле справа
- **Margin Above** (7.4.10.3) — пространство над головой
- **Margin Below** (7.4.10.4) — пространство ниже подбородка

Все четыре подкомпонента обязательны для всех трёх сценариев. Оценка вычисляется из ландмарков лица относительно границ изображения в соответствии с требованиями кадрирования ISO/IEC 39794-5.

### Формат, цветовое пространство, глубина цвета

По ISO/IEC 19794-5 и ICAO Doc 9303:

- **Цветовое пространство**: **sRGB** (IEC 61966-2-1) — обязательное для цветных изображений
- **Глубина цвета**: **24 бита** (8 бит на канал RGB); принимается также **8-бит greyscale**
- **Входной формат в 29794-5**: стандарт описывает предобработку для 8-bit greyscale и 24-bit colour, с конверсией из 16-бит при необходимости (Clause 6.2–6.3)
- **Форматы сжатия** (определены в ISO/IEC 19794-5): JPEG Baseline Sequential (ISO/IEC 10918-1), JPEG2000 Part-1 (ISO/IEC 15444-1, lossy или lossless), PNG (ISO/IEC 15948, lossless)
- **Разрешение печати**: ≥ **300 DPI** (рекомендация для сканирования/печати); минимум **90 DPI**

---

## Требования к позиции головы и углы поворота

### Head Pose (7.4.11) — три подкомпонента

Поза головы определяется тремя осями вращения согласно системе координат ISO/IEC 39794-5:2019 (Clause 7.21):

**Pose Angle Yaw** (7.4.11.2) — поворот головы влево/вправо. Нативная мера — угол в градусах от фронтального положения (0° = идеально фронтально). Обязателен для UC1 и UC2.

**Pose Angle Pitch** (7.4.11.3) — наклон головы вверх/вниз. Та же система. Обязателен для UC1 и UC2.

**Pose Angle Roll** (7.4.11.4) — наклон головы в плоскости изображения (ухо к плечу). Обязателен для UC1 и UC2.

Каждый подкомпонент оценивается по шкале 0–100, где 100 означает идеально фронтальное положение. Числовые пороги по ссылочным стандартам:

- **ICAO Doc 9303 / ISO 19794-5 для Full Frontal**: допустимое отклонение **≤ ±5°** по каждой из трёх осей (yaw, pitch, roll)
- **Исследования (arXiv:2303.00491)**: pitch более **±30°** критически снижает точность распознавания
- **NIST FATE**: использует штрафную функцию `F(ϕ) = 1 − cos(aϕ)` с масштабным коэффициентом «a», причём система более толерантна к ошибкам pitch и менее — к roll

Алгоритм эталонной реализации OFIQ: CNN **3DDFA_V2** (обучена на 300W-LP dataset), выдаёт матрицу вращения, из которой извлекаются yaw, pitch, roll.

---

## Требования к освещению и экспозиции

### Illumination Uniformity (7.3.3)

Оценивает **равномерность освещения лица** — отсутствие теней и асимметричного света. Методология: вычисление пересечения гистограмм яркости для зон левой и правой щёк (определённых через face parsing CNN). Чем ближе гистограммы — тем выше оценка. Обязателен для UC1.

По ICAO Doc 9303: экспозиция измеряется в четырёх точках (левая щека, правая щека, лоб, подбородок) — разница не должна превышать **1 F-stop** или **1 шаг выдержки**. Рекомендуется калибровка по **18% серой карте**.

### Luminance Mean (7.3.4.2) и Luminance Variance (7.3.4.3)

Статистические моменты распределения яркости в области лица. Конверсия в яркость: **Y = 0.2126R + 0.7152G + 0.0722B** (после инверсии гаммы). Luminance Variance обязательна для UC1 — слишком малая вариация указывает на плоское, неинформативное освещение.

### Under-Exposure Prevention (7.3.5) и Over-Exposure Prevention (7.3.6)

Подсчитывают долю пикселей в области лица с экстремально низкой (underexposure) или высокой (overexposure) яркостью. Чем меньше таких пикселей — тем выше оценка. Оба компонента необязательны, но информативны. **Примечание**: для Under-Exposure Prevention выявлена демографическая предвзятость (Bias), запланировано улучшение в OFIQ 2.0.

### Dynamic Range (7.3.7)

Оценивает тональный диапазон изображения. Нативная мера — **энтропия гистограммы яркости** в битах:

**H = −Σ pᵢ log₂ pᵢ**

где pᵢ — нормализованная доля пикселей в бине гистограммы. Для 8-bit изображения теоретический диапазон [0, 8]. Порог: энтропия **≥ 7 бит** считается приемлемой (что соответствует требованию ISO/IEC 39794-5:2019 D.2.4.2 — не менее **128 уникальных значений яркости** в области лица). Обязателен для UC1.

---

## Требования к фону

### Background Uniformity (7.3.2)

Оценивает однородность фона за объектом — отсутствие текстур, объектов, теней, градиентов. Нативная мера: вариация яркости/цвета пикселей фона. Область фона определяется через face parsing CNN (CelebMask-HQ). Обязателен для UC1.

По ICAO Doc 9303 фон должен быть:

- **Однотонным** (plain, uniform), без текстуры (точек, линий, узоров)
- **Цвет**: серый, светло-серый, белый или светло-голубой
- **Без теней** (особенно асимметричных)
- **Без посторонних объектов**
- С достаточным контрастом между лицом/волосами и фоном

---

## Требования к глазам

### Eyes Open (7.4.3)

Оценивает степень открытости глаз. Алгоритм OFIQ — landmark-based:

**EyesOpen = min(D_L, D_R) / T**

где D_L, D_R — расстояние между верхним и нижним веком для левого и правого глаза, T — расстояние от средней точки между глазами до подбородка. Обязателен для UC1. В NIST FATE: OFIQ занял **1-е место из 22** алгоритмов, без выявленной этнической предвзятости.

### Eyes Visible (7.4.5)

Проверяет, что оба глаза не закрыты волосами, оправой очков, бликами или другими окклюзиями. Основан на CNN сегментации окклюзий (FaceExtraction), оценивается зона видимости глаз (EVZ). Обязателен для UC1 и UC2.

### Gaze (D.3.1) — направление взгляда

Информативный (необязательный) компонент из Annex D. Оценивает, смотрит ли субъект прямо в камеру. Запланирован для добавления в OFIQ 2.0.

По ICAO: взгляд должен быть направлен **непосредственно в объектив камеры**.

---

## Выражение лица и рот

### Expression Neutrality (7.4.12)

Оценивает нейтральность выражения лица — отсутствие улыбки, хмурости, других мимических проявлений. Алгоритм OFIQ: CNN, обученная на OFIQ Development Dataset. Обязателен для UC1.

По ICAO допускается: нейтральное выражение или **улыбка с закрытым ртом**. Недопустимы: открытый рот, нахмуренные брови, искажённая мимика.

### Mouth Closed (7.4.4)

Проверяет, что рот закрыт. Формула OFIQ:

**MouthOpen = max_lip_separation / T**

Высокое значение lip separation → низкая оценка Mouth Closed. Обязателен для UC1 и UC2. В NIST FATE: OFIQ — **2-е место из 19** алгоритмов.

---

## Окклюзия лица: очки, головные уборы, волосы

### Face Occlusion Prevention (7.4.7)

Основной компонент оценки окклюзии. Определяет долю незакрытой области лица с помощью CNN сегментации (FaceExtraction, обучена на CelebMask-HQ). Детектирует: волосы (не лицевые), объекты (маски, солнечные очки), части тела (рука, язык), оправы/блики на очках. Обязателен для UC1 и UC2. В NIST FATE: **1-е место из 20** алгоритмов.

### Mouth Occlusion Prevention (7.4.6)

Аналогичный подход, сфокусированный на области рта. Обязателен для UC1 и UC2.

### No Head Covering (7.4.13)

Детектирует головные уборы (шляпы, шарфы, платки) через face parsing CNN. Обязателен для UC1. По ICAO: головные уборы **не допускаются**, за исключением религиозных, медицинских или культурных причин, одобренных компетентным органом государства. Лицо должно быть полностью видимым от подбородка до макушки.

По ICAO для аксессуаров:

- **Очки**: без тонированных линз, без бликов, оправа не должна закрывать глаза. ICAO всё чаще рекомендует **снимать очки**. Толщина оправы не более **5% от IED** (ISO/IEC 39794-5 Annex D.2)
- **Слуховые аппараты, парики**: допустимы, если не закрывают лицо
- **Наушники, Bluetooth-устройства**: **не допускаются**
- **Временные украшения**: не допускаются

---

## Фокусировка, резкость и компрессионные артефакты

### Sharpness (7.3.8)

Оценивает чёткость мелких деталей лица. Алгоритм OFIQ — Random Forest классификатор с признаками: отклик **фильтра Собеля**, отклик **фильтра Лапласа**, разность изображения и его mean-filtered версии. Обучен на синтетическом и реальном размытии, ограничен landmarked region. Обязателен для UC1. В NIST FATE: **5-е место из 34**.

По ICAO: камера должна отображать контрастные детали лица размером до **1 мм** на поверхности. Глубина резкости: от носа до ушей (минимум), best practice — **15 см от плоскости носа**.

### No Compression Artefacts (7.3.9)

Детектирует блочные и кольцевые артефакты JPEG/JPEG2000. Алгоритм OFIQ: CNN secunet, предсказывающая **PSNR** между сжатым и оригинальным изображением. Обучена на JPEG и JPEG2000 артефактах, включая масштабированные и повёрнутые. Необязателен. В NIST FATE: 10-е из 20.

### Motion Blur Prevention (D.3.4)

Информативный компонент Annex D — детектирует motion blur отдельно от общей резкости. Запланирован для OFIQ 2.0.

---

## Цвет кожи и естественность цвета

### Natural Colour (7.3.10)

Оценивает естественность цветопередачи — отсутствие цветовых сдвигов (casts), неестественного баланса белого, эффекта красных глаз. Методология: анализ в цветовом пространстве **CIELAB** (конверсия из 8-bit RGB по Clause 6.13). Оценивается естественность цвета кожных регионов. Необязателен для всех сценариев.

По ICAO: обязательно **естественное представление тона кожи**. Цифровая коррекция динамического диапазона или цветов **не допускается**. Все цветовые каналы в области лица должны иметь не менее **50% вариации интенсивности**.

---

## Вычислительный конвейер стандарта

Clause 6 определяет общие вычисления (pre-processing pipeline), используемые несколькими компонентами качества. Стандарт задействует **8 нейросетевых моделей**:

| Шаг | Описание | Алгоритм/Модель |
|---|---|---|
| Face Detection (6.4) | Bounding box всех лиц | SSD CNN (OpenCV DNN) |
| Landmark Estimation (6.5) | 98 ландмарков лица | ADNet CNN (WFLW dataset) — наиболее затратный шаг |
| Landmarked Region (6.6) | Минимальная выпуклая область ландмарков | Брови–подбородок, ухо–ухо (без ушей) |
| Face Alignment (6.7) | Нормализация позы | Глаза на одной высоте |
| Face Parsing (6.8) | Семантическая сегментация | face-parsing.PyTorch (CelebMask-HQ) |
| Occlusion Segmentation (6.9) | Незакрытая область лица | FaceExtraction CNN (CelebMask-HQ) |
| Eye Centres (6.10) | Центры глаз, IED | Из ландмарков |
| Head Pose (6.11) | Yaw, pitch, roll | 3DDFA_V2 CNN (300W-LP) |
| Colour→Luminance (6.12) | Y = 0.2126R + 0.7152G + 0.0722B | После инверсии гаммы |
| Colour→CIELAB (6.13) | Для Natural Colour | Стандартная конверсия |
| Luminance Histogram (6.15) | Распределение яркости | Гистограммный анализ |
| Entropy (6.16) | H = −Σ pᵢ log₂ pᵢ | Для Dynamic Range |

Unified Quality Score вычисляется моделью **MagFace** (iResNet-50, обучена на MS1MV2). Принцип: **L2-норма вектора эмбеддинга** монотонно возрастает для более качественных (лучше распознаваемых) изображений. MagFace использует адаптивную angular margin loss.

---

## Сводная таблица числовых пороговых значений

| Параметр | Значение | Источник |
|---|---|---|
| Диапазон всех QCV и UQS | **0–100** (целое число) | ISO/IEC 29794-1 |
| Failure to assess | **-1** | ISO/IEC 29794-5 |
| Min IED (обязательный) | **≥ 90 px** | ICAO / ISO 19794-5 |
| Best practice IED (чип) | **≥ 120 px** | ICAO TR Portrait Quality |
| Best practice IED (захват) | **≥ 240 px** | ICAO TR Portrait Quality |
| Размер захвата (рекомендация) | **1200 × 1600 px** | ICAO TR Portrait Quality |
| Допустимое отклонение позы (yaw, pitch, roll) | **≤ ±5°** | ISO 19794-5 / ICAO |
| Критический порог pitch | **> ±30°** | arXiv:2303.00491 |
| Энтропия Dynamic Range | **≥ 7 бит** | NIST / ISO 39794-5 D.2.4.2 |
| Мин. уникальных значений яркости | **≥ 128** | ISO 39794-5 D.2.4.2 |
| Размер лица (цифровое изображение) | **50–69%** высоты кадра | ICAO |
| Размер лица (физическое фото 35×45 мм) | **32–36 мм** | ICAO |
| Толщина оправы очков | **≤ 5% от IED** | ISO 39794-5 Annex D.2 |
| Camera Subject Distance (1:1) | **0.7–4.0 м** (best practice 1.0–2.5 м) | ICAO TR Portrait Quality |
| Camera Subject Distance (1:N) | **1.0–4.0 м** (best practice 1.2–2.5 м) | ICAO TR Portrait Quality |
| Radial distortion | **< 2.5%** (< 2% незаметна) | ICAO TR Portrait Quality |
| Magnification distortion (1:1 / 1:N) | **≤ 7% / ≤ 5%** | ICAO TR Portrait Quality |
| Глубина резкости | **От носа до ушей** (min) | ICAO |
| Разность освещения (лицо) | **≤ 1 F-stop** | ICAO |
| DPI печати/сканирования | **≥ 300 DPI** (рекомендация) | ICAO |
| Цветовое пространство | **sRGB** | ICAO / ISO 19794-5 |
| Глубина цвета | **24 бита** (8 бит/канал) | ICAO / ISO 19794-5 |
| Мин. IED для подсчёта лиц | **≥ 0.02W** (W = ширина изображения) | ISO 29794-5 |

---

## Связь с ICAO Doc 9303 и ISO/IEC 19794-5

Три стандарта образуют иерархическую систему. **ICAO Doc 9303** — прикладной стандарт верхнего уровня, обязывающий использовать лицевую биометрию как основную для всех eMRTD и определяющий хранение в Data Group 2 (DG2) LDS чипа. **ISO/IEC 19794-5** (и его преемник ISO/IEC 39794-5) — стандарт формата данных, задающий структуру записи, типы изображений (Basic, Frontal, Full Frontal, Token Frontal), сценические и фотографические ограничения. **ISO/IEC 29794-5** — стандарт оценки качества, определяющий алгоритмы количественного измерения соответствия требованиям двух предыдущих стандартов.

Каждый компонент качества в 29794-5 прямо маппится на конкретное требование ICAO/19794-5. Например, Background Uniformity → ICAO «plain uniform background»; Pose Angle Yaw → ICAO/19794-5 «≤ ±5° от фронтального»; Dynamic Range → ISO 39794-5 «≥ 128 unique values».

Важный переходный период: к **01-01-2026** инспекционные системы обязаны поддерживать ISO/IEC 39794; с **01-01-2030** все эмитенты обязаны использовать только ISO/IEC 39794-X; ISO/IEC 19794 будет полностью устаревшим к **2040 году**.

ISO/IEC 19794-5 определяет **шесть типов лицевых изображений**: Basic → Frontal → Full Frontal, Token Frontal, Post-processed Frontal, а также 3D-варианты. Для паспортов и MRTD используется преимущественно Full Frontal, для чипового хранения с минимальным объёмом — Token Frontal. Каждый тип наследует и ужесточает требования предыдущего.

---

## Open-source реализации и интеграция с .NET/WebAssembly

### OFIQ — эталонная реализация (рекомендуется)

**GitHub**: https://github.com/BSI-OFIQ/OFIQ-Project. Лицензия **MIT**. Язык: **C/C++**. Поддержка: Linux, Windows, macOS, **Android** (APK), **iOS** (framework). Версия 1.0.1; OFIQ 2.0 запланирован к концу 2027 года. Поддерживается BSI (Германия) и eu-LISA. Реализует все 28 основных компонентов качества ISO/IEC 29794-5. В NIST FATE: UQS — **1-е из 52**, Face Occlusion — **1-е из 20**, Eyes Open — **1-е из 22**.

Нативных .NET-биндингов и WebAssembly-сборки **не существует**. Интеграция в .NET возможна через **P/Invoke** (сборка OFIQ как shared library, создание C#-обёрток). Компиляция в WASM через Emscripten **теоретически возможна**, но крайне сложна из-за зависимостей от ONNX Runtime и OpenCV.

### BQAT-API — REST-обёртка над OFIQ (лучший путь для .NET)

**GitHub**: https://github.com/Biometix/bqat-api. Фреймворк **FastAPI** (Python), Docker-контейнер. Оборачивает OFIQ, BIQT и собственный движок Biometix. Предоставляет **REST API**, доступное из .NET через `HttpClient`. Есть также BQAT-CLI и BQAT-GUI. Использует Ray для параллельной обработки. Это **наиболее практичный open-source путь** для доступа к ISO 29794-5 компонентам из .NET.

### BIQT — Biometric Image Quality Toolkit (MITRE)

**GitHub**: https://github.com/mitre/biqt-face. Лицензия **Apache 2.0**. C++, Docker. Расширяемая архитектура плагинов. Общая оценка качества 0–10. Нет .NET/WASM/REST.

### Академические реализации unified quality score

| Инструмент | GitHub | Метод | Лицензия | Язык |
|---|---|---|---|---|
| **SER-FIQ** | github.com/pterhoer/FaceImageQuality | Стохастическая робастность эмбеддингов (CVPR 2020) | Research | Python/MXNet |
| **CR-FIQA** | github.com/fdbtrs/CR-FIQA | Classifiability ratio (CVPR 2023) | CC BY-NC 4.0 | Python/PyTorch |
| **MagFace** | github.com/IrvingMeng/MagFace | Магнитуда эмбеддинга (CVPR 2021) | MIT | Python/PyTorch |
| **SDD-FIQA** | github.com/Tencent/TFace (branch quality) | Similarity distribution distance (CVPR 2021) | Tencent | Python/PyTorch |
| **FaceQnet** | github.com/uam-biometrics/FaceQnet | ResNet-50 fine-tuned (ICB 2019) | Research | Python/Keras |
| **GraFIQs** | github.com/jankolf/GraFIQs | Градиенты весов FR-модели (CVPRW 2024) | CC BY-NC 4.0 | Python/PyTorch |
| **FIQAT** | code.fbi.h-da.de/hda10196/face-image-quality-toolkit | Тулкит: CR-FIQA, MagFace, FaceQnet, SER-FIQ | MIT | Python |

Все перечисленные академические реализации — **только Python**, без .NET/WASM. Реализуют только **holistic unified quality score**, не покомпонентную оценку ISO 29794-5.

### Коммерческие инструменты с API

**Regula Face SDK** — 45 параметров качества, профили ICAO/Schengen/US Visa. **REST API** с OpenAPI-спецификацией, **C#/.NET SDK**, 30-дневный бесплатный триал. Лучший коммерческий вариант для .NET.

**Innovatrics DOT Face SDK** — ICAO-compliance, REST API (SmartFace Platform), JavaScript web component (@innovatrics/dot-face-auto-capture, использует WASM внутри). Freemium с водяным знаком.

**Neurotechnology VeriLook/MegaMatcher** — среди лидеров NIST FATE Quality. Традиционно предоставляет **.NET SDK** (Windows, Linux, macOS, Android, iOS).

### Сводная матрица совместимости

| Инструмент | .NET | WebAssembly | REST API | Open-source |
|---|---|---|---|---|
| **OFIQ** | P/Invoke (вручную) | Теоретически (Emscripten) | ❌ | ✅ MIT |
| **BQAT-API** | Через HTTP | ❌ | ✅ FastAPI | ✅ |
| **BIQT** | ❌ | ❌ | ❌ | ✅ Apache 2.0 |
| **Regula Face SDK** | ✅ SDK + REST | ❌ | ✅ OpenAPI | ❌ (trial) |
| **Innovatrics** | Через REST | ⚠️ JS component | ✅ REST | ❌ (freemium) |
| **Neurotechnology** | ✅ Native SDK | ❌ | ❌ | ❌ |

---

## Как качество влияет на распознавание

Данные NIST FATE подтверждают **сильную корреляцию** между quality score и точностью распознавания. Фильтрация **1% наихудших** изображений по UQS снижает FNMR с 0.01 до **0.0059** (сокращение на 41%). Фильтрация **5%** даёт ещё более значительное улучшение. MagFace (основа UQS в OFIQ) математически гарантирует монотонную связь между магнитудой эмбеддинга и косинусным сходством с центром класса.

Выявлены проблемы **демографической предвзятости**: некоторые компоненты (особенно Under-Exposure Prevention) систематически занижают оценки для определённых демографических групп. NIST добавил анализ по региону рождения и полу в отчёты FATE SIDD с ноября 2024. В OFIQ 2.0 запланирована коррекция bias для ряда компонентов.

---

## Заключение: ключевые выводы и практические рекомендации

ISO/IEC 29794-5:2025 завершил многолетний процесс стандартизации оценки качества лицевых изображений, превратив его из субъективной экспертной оценки в **алгоритмически определённый, воспроизводимый процесс с 34 компонентами**. Три критически важных архитектурных решения стандарта — единая шкала 0–100, разделение на capture-related и subject-related компоненты, и дифференциация требований по трём сценариям — делают его применимым от паспортных фотобудок до пограничных ABC-гейтов.

Для практической интеграции в .NET/WebAssembly-проекты **оптимальная стратегия** — развернуть BQAT-API (Docker-контейнер с OFIQ внутри) как микросервис и обращаться к нему через REST из .NET-приложения. Это обеспечивает полное покрытие всех 28 компонентов ISO 29794-5 с open-source стеком. Для enterprise-проектов, требующих нативной .NET-интеграции и коммерческой поддержки, Regula Face SDK предлагает наиболее зрелый вариант с OpenAPI и готовым C#-SDK. WebAssembly-реализации ISO 29794-5 на данный момент **не существует** ни в одном проекте — это потенциальная ниша для разработки.

Развитие стандарта продолжается: OFIQ 2.0 (целевой срок — конец 2027) добавит gaze detection, motion blur prevention, улучшит точность background uniformity и expression neutrality, и уменьшит демографическую предвзятость. Параллельно уже начата разработка следующей редакции самого ISO/IEC 29794-5 (проект AWI 29794-5, номер 92472).